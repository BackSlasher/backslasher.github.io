<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Open-Gridview - the FOSS Out-Gridview - BackSlasher</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://blog.backslasher.net/open-gridview.html">

        <meta name="author" content="Nitz" />
        <meta name="keywords" content="Python,PowerShell,Scripts" />
        <meta name="description" content="The Story I&#39;ve been a Microsoft SysAdmin for a long time before switching for Linux. During which, I scripted a lot in PowerShell. PowerShell has several &#34;output&#34; functions like Out-File (which passes the input to a file), Out-Null etc. One of these functions was Out-Gridview which tabularizes its input and …" />

        <meta property="og:site_name" content="BackSlasher" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Open-Gridview - the FOSS Out-Gridview"/>
        <meta property="og:url" content="https://blog.backslasher.net/open-gridview.html"/>
        <meta property="og:description" content="The Story I&#39;ve been a Microsoft SysAdmin for a long time before switching for Linux. During which, I scripted a lot in PowerShell. PowerShell has several &#34;output&#34; functions like Out-File (which passes the input to a file), Out-Null etc. One of these functions was Out-Gridview which tabularizes its input and …"/>
        <meta property="article:published_time" content="2015-12-13" />
            <meta property="article:section" content="FOSS" />
            <meta property="article:tag" content="Python" />
            <meta property="article:tag" content="PowerShell" />
            <meta property="article:tag" content="Scripts" />
            <meta property="article:author" content="Nitz" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blog.backslasher.net/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://blog.backslasher.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blog.backslasher.net/theme/css/pygments/default.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.backslasher.net/theme/css/style.css" type="text/css"/>

        <link href="https://blog.backslasher.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="BackSlasher ATOM Feed"/>

        <link href="https://blog.backslasher.net/feeds/foss.atom.xml" type="application/atom+xml" rel="alternate"
              title="BackSlasher FOSS ATOM Feed"/>
</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blog.backslasher.net/" class="navbar-brand">
BackSlasher            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://blog.backslasher.net/pages/about.html">
                             About
                          </a></li>
                         <li><a href="https://blog.backslasher.net/pages/projects.html">
                             Projects
                          </a></li>
                        <li class="active">
                            <a href="https://blog.backslasher.net/category/foss.html">Foss</a>
                        </li>
                        <li >
                            <a href="https://blog.backslasher.net/category/microsoft.html">Microsoft</a>
                        </li>
                        <li >
                            <a href="https://blog.backslasher.net/category/misc.html">Misc</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://blog.backslasher.net/open-gridview.html"
                       rel="bookmark"
                       title="Permalink to Open-Gridview - the FOSS Out-Gridview">
                        Open-Gridview - the FOSS Out-Gridview
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-12-13T00:00:00+01:00"> Sun 13 December 2015</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://blog.backslasher.net/tag/python.html">Python</a>
        /
	<a href="https://blog.backslasher.net/tag/powershell.html">PowerShell</a>
        /
	<a href="https://blog.backslasher.net/tag/scripts.html">Scripts</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h2>The Story</h2>
<p>I've been a Microsoft SysAdmin for a long time before switching for Linux. During which, I scripted a lot in PowerShell.<br>
PowerShell has several "output" functions like <code>Out-File</code> (which passes the input to a file), <code>Out-Null</code> etc.<br>
One of these functions was <a href="https://technet.microsoft.com/en-us/library/hh849920.aspx">Out-Gridview</a> which tabularizes its input and displays it in an interactive table:<br>
<img alt="out-gridview" src="https://blog.backslasher.net/images/open-gridview/out-gridview.jpg"><br>
You can see how easy it is to tabulate your objects.  </p>
<p>The advantage might be hard to explain to hardcore *nix CLI users - they might scoff and say that you can filter using <code>grep</code>, sort using <code>sort</code> and extract columns using <code>awk</code>, and that all output is beautiful in its own way.<br>
However, since switching to Linux I've had numerous incidents of either trying to format my output so that it is both readable and parsable, or piping output to some filter and regret filtering it. How I missed being able to pass the output to <code>Out-Gridview</code> and being able to manipulate it via GUI.</p>
<h2>The Solution</h2>
<p>I've decided that Out-Gridview is a basic enough problem so I can tackle it, and also writing UI is fun (as if), so I implemented it via GTK and Python.<br>
The result is the package <a href="https://pypi.python.org/pypi/opengridview">opengridview</a>.  </p>
<h3>Installation</h3>
<p>For regular usage, use the pip package:</p>
<div class="highlight"><pre><span></span><code>sudo pip install opengridview
</code></pre></div>

<p>For modification and hacking, set up a venv in the git repo:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/BackSlasher/opengridview .
virtualenv . --system-site-packages
. bin/activate
pip install -e .
</code></pre></div>

<h3>Basic usage</h3>
<p>To use it, pipe your output into <code>ogv</code> (or <code>open-gridview</code>), optionally specifying how to parse each row (the default is "autosplit") and how the columns are named (usually the first row is taken as a header row).<br>
<code>ogv</code> can accept regular files, but it's more interesting to pipe streams into it.<br>
Multiple files can be passed (causing multiple windows to appear) by using bash's <a href="http://tldp.org/LDP/abs/html/process-sub.html">process substitution</a>:</p>
<div class="highlight"><pre><span></span><code>ogv &lt;<span class="o">(</span>ls -l /home/bob <span class="p">|</span> tail -n+2<span class="o">)</span> &lt;<span class="o">(</span>ls -l /var <span class="p">|</span> tail -n+2<span class="o">)</span> --headers permissions,links,user,group,size,mod-month,mod-day,mod-time,name
</code></pre></div>

<h3>Parsers</h3>
<h4>autosplit</h4>
<p>Emulates perl's <code>autosplit</code>, using <code>re.split</code> and a delimiter (defaults to <code>\s+</code>)</p>
<h4>csv</h4>
<p>Uses the <code>csv</code> module to prase every line. Configurable delimeter (defaults to <code>,</code>)</p>
<h4>line_json</h4>
<p>Treats each line as a separate JSON object</p>
<h3>Neat features</h3>
<ul>
<li>
<p>The autosplit parser uses <code>re.split</code> to create the columns. This method honors capturing groups inside the separator, meaning you can use the separator as a Regex parser, and discard the "split" columns using empty column headers, like this:</p>
<div class="highlight"><pre><span></span><code>pip list <span class="p">|</span> ogv -s <span class="s1">&#39;^([^ ]*) \(([^ ]*)\)$&#39;</span> --headers ,name,version
</code></pre></div>

<p>(see below for screenshot of the result)</p>
</li>
<li>
<p>I implemented <code>Ctrl+c</code> (inside the GUI) to copy selected rows as CSV text, in order to ease copying data into spreadsheet applications (a common action for me when handling tabulated data)</p>
</li>
</ul>
<h2>Example use cases</h2>
<h3>Filesystem stuff</h3>
<div class="highlight"><pre><span></span><code>ls -l <span class="p">|</span> tail -n+2 <span class="p">|</span> ogv --headers permissions,links,user,group,size,mod-month,mod-day,mod-time,name <span class="p">&amp;</span>
du -h <span class="p">|</span> ogv --separator <span class="s1">&#39;\t&#39;</span> --headers size,path <span class="p">&amp;</span>
<span class="nb">wait</span>
</code></pre></div>

<p><img alt="" src="https://blog.backslasher.net/images/open-gridview/filesystem.png"></p>
<h3>Show all packages installed</h3>
<p>Preset the filter to "python"</p>
<div class="highlight"><pre><span></span><code>aptitude search ~i --disable-columns -F <span class="s1">&#39;%p,%v,%t&#39;</span> <span class="p">|</span> ogv -p csv --headers name,version,source --filter python
</code></pre></div>

<p><img alt="" src="https://blog.backslasher.net/images/open-gridview/aptitude.png"></p>
<h3>Pip package list</h3>
<p>Custom headers, column extraction using capturing groups</p>
<div class="highlight"><pre><span></span><code>pip list <span class="p">|</span> ogv -s <span class="s1">&#39;^([^ ]*) \(([^ ]*)\)$&#39;</span> --headers ,name,version
</code></pre></div>

<p><img alt="" src="https://blog.backslasher.net/images/open-gridview/pip.png"></p>
<h3>Multiple module search</h3>
<div class="highlight"><pre><span></span><code><span class="o">(</span>
  <span class="nb">echo</span> platform name version
  pip list <span class="p">|</span> perl -ne <span class="s1">&#39;print &quot;python $_&quot;&#39;</span><span class="p">;</span>
  gem list <span class="p">|</span> grep <span class="s1">&#39;(&#39;</span> <span class="p">|</span> perl -ne <span class="s1">&#39;print &quot;ruby $_&quot;&#39;</span>
<span class="o">)</span> <span class="p">|</span> ogv
</code></pre></div>

<p><img alt="" src="https://blog.backslasher.net/images/open-gridview/pip-gem.png"></p>
<h2>Interesting bits</h2>
<ul>
<li>I chose to implement Open-Gridview on GTK because I'm running Gnome</li>
<li>I chose Python (as opposed to Ruby / Perl) because Python comes preinstalled on most major Linux distros</li>
<li>Since I chose <a href="https://wiki.gnome.org/action/show/Projects/PyGObject?action=show&amp;redirect=PyGObject">PyGObject</a> as my GTK library, I'm annoyingly missing some features, like:<ul>
<li>Writing custom data to the clipboard</li>
<li>Directly connecting functions to key shortcuts (I'm currently using menu items as a middleman)</li>
<li>The <code>Gtk.Application</code> class forces "single-instance" applications on you (think firefox). Although there was <a href="https://mail.gnome.org/archives/gtk-devel-list/2011-February/msg00091.html">some discussion</a> about this decision, it seems mandated. I had to work around this by managing multiple <code>Gtk.Window</code> instances by myself</li>
</ul>
</li>
<li>Some Python utilities (e.g. <code>csv.reader</code>) use internal buffering when reading streams. This means that using them directly caused delay when parsing a live stream (and not a file). I'm currently reading one line at a time, then feeding it to a parser. This is also why all current parsers are line-based</li>
<li>I found no easy/elegant way to interrupt streams while they were waiting for input. Eventually I found about "daemon threads", which are threads that don't justify keeping the process alive (if only daemon threads are left, the process is closed)</li>
</ul>
<h2>TODOs</h2>
<ul>
<li>Add item selection functionality (like out-gridview's <code>OutputMode</code>)</li>
<li>Support advanced filtering (e.g. regex, specific columns)</li>
<li>Support hiding and re-ordering columns</li>
<li>Add a progress bar if the stream isn't closed (EOFed)</li>
</ul>
<p>Please let me know if you find this useful.</p>
            </div>
            <!-- /.entry-content -->

<div id="graphcomment"></div>
<script type="text/javascript">

  /* - - - CONFIGURATION VARIABLES - - - */

  // make sure the id is yours
  window.gc_params = {
    graphcomment_id: 'Backslasher-net',

    // if your website has a fixed header, indicate it's height in pixels
    fixed_header_height: 0,
  };

  /* - - - DON'T EDIT BELOW THIS LINE - - - */

  
  (function() {
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.src = 'https://graphcomment.com/js/integration.js?' + Math.round(Math.random() * 1e8);
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();

</script>        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="http://github.com/BackSlasher"><i class="fa fa-github-square fa-lg"></i> github</a></li>
    <li class="list-group-item"><a href="http://il.linkedin.com/in/nitzanraz/"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
    <li class="list-group-item"><a href="http://careers.stackoverflow.com/backslasher"><i class="fa fa-stack-overflow fa-lg"></i> stack-overflow</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="https://blog.backslasher.net/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group " id="tags">
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/scripts.html">Scripts</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/powershell.html">PowerShell</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/linux.html">Linux</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/security.html">Security</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/mysteries-solved.html">Mysteries Solved</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/active-directory.html">Active Directory</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/ruby.html">Ruby</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/windows.html">Windows</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/chef.html">Chef</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/bash.html">Bash</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/ramblings.html">Ramblings</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/python.html">Python</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/one-liner.html">One-Liner</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/group-policy.html">Group Policy</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/sharepoint.html">SharePoint</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="https://blog.backslasher.net/tag/http.html">HTTP</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="https://blog.backslasher.net/tag/registry.html">Registry</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://blog.backslasher.net/tag/filesystem.html">FileSystem</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://blog.backslasher.net/tag/programming.html">Programming</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://blog.backslasher.net/tag/kerberos.html">Kerberos</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://getpelican.com/" target="_blank">Pelican</a>
    </li>
    <li class="list-group-item">
      <a href="http://python.org/" target="_blank">Python.org</a>
    </li>
    <li class="list-group-item">
      <a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2020 Nitz
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blog.backslasher.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blog.backslasher.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blog.backslasher.net/theme/js/respond.min.js"></script>


    <!-- Google Analytics Universal -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-9527207-7', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics Universal Code -->


</body>
</html>