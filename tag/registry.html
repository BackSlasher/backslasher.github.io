<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Registry - BackSlasher</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




    <meta name="author" content="Nitz" />
    <meta name="keywords" content="Registry" />

    <!-- Open Graph tags -->
        <meta property="og:site_name" content="BackSlasher" />
        <meta property="og:type" content="website"/>
        <meta property="og:title" content="BackSlasher"/>
        <meta property="og:url" content="https://blog.backslasher.net"/>
        <meta property="og:description" content="BackSlasher"/>



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blog.backslasher.net/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://blog.backslasher.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blog.backslasher.net/theme/css/pygments/default.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.backslasher.net/theme/css/style.css" type="text/css"/>

        <link href="https://blog.backslasher.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="BackSlasher ATOM Feed"/>


</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blog.backslasher.net/" class="navbar-brand">
BackSlasher            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://blog.backslasher.net/pages/about.html">
                             About
                          </a></li>
                         <li><a href="https://blog.backslasher.net/pages/projects.html">
                             Projects
                          </a></li>
                        <li >
                            <a href="https://blog.backslasher.net/category/foss.html">Foss</a>
                        </li>
                        <li >
                            <a href="https://blog.backslasher.net/category/microsoft.html">Microsoft</a>
                        </li>
                        <li >
                            <a href="https://blog.backslasher.net/category/misc.html">Misc</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <article>
                <h2><a href="https://blog.backslasher.net/list-all-group-policy-extensions-registered.html">List all Group Policy Extensions Registered</a></h2>
                <div class="summary"><p>I use this script to see all GP extensions that my computer can
process:  </p>
<div class="highlight"><pre><span></span><code><span class="nb">ls </span><span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions&#39;</span> <span class="p">|</span> <span class="nb">select </span><span class="p">`</span>
    <span class="p">@{</span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;Guid&#39;</span><span class="p">;</span><span class="n">expression</span><span class="p">={</span><span class="no">[guid]</span><span class="nv">$_</span><span class="p">.</span><span class="n">pschildname</span><span class="p">}}</span>
    <span class="p">@{</span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;Name&#39;</span><span class="p">;</span><span class="n">expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)}}</span>
    <span class="p">@{</span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;DllName&#39;</span><span class="p">;</span><span class="n">expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s1">&#39;DllName&#39;</span><span class="p">)}}</span>
    <span class="p">@{</span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;ProcessWhenNoChanges&#39;</span><span class="p">;</span><span class="n">expression</span><span class="p">={!</span><span class="nv">$_</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s1">&#39;NoGPOListChanges&#39;</span><span class="p">)}}</span>
    <span class="p">@{</span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;IsUserPolicy&#39;</span><span class="p">;</span><span class="n">expression …</span></code></pre></div>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/list-all-group-policy-extensions-registered.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.backslasher.net/putting-your-windows-to-sleep.html">Putting your Windows to sleep</a></h2>
                <div class="summary"><p><img alt="" src="https://blog.backslasher.net/images/putting-your-windows-to-sleep/PowerZoe.jpg"></p>
<p>Although there are many blog posts about configuring standby ("sleep")
in Windows, each one with its own insomnia joke, I thought I'd share my
methodology .  </p>
<h3><code>PowerCfg -energy</code>:  The one tool to sort it all</h3>
<p>I only learnt about this command near the end of my testing, but it
still managed …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/putting-your-windows-to-sleep.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.backslasher.net/remotely-changing-dns-server-list.html">Remotely changing DNS server list through registry</a></h2>
                <div class="summary"><p>Recently I was called to help some some friends who had an unusual problem:<br>
They demoted an old DC because they needed to raise the domain functional level, and after doing so many of their servers stopped working - they wouldn't allow remote logins, the Exchange services wouldn't start, while showing …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/remotely-changing-dns-server-list.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.backslasher.net/solving-event-log-subscription-error-0x138c.html">Solving Event Log Subscription Error "0x138C"</a></h2>
                <div class="summary"><p>Today I saw some collector-initiated event log subscriptions that
displayed a weird error, something like  </p>
<div class="highlight"><pre><span></span><code>Windows Event Forward plugin can&#39;t read any event from the query since the query returns no active channel. Please check channels in the query and make sure they exist and you have access to …</code></pre></div>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/solving-event-log-subscription-error-0x138c.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.backslasher.net/finding-wsus-clients-by-susclientid.html">Finding WSUS Clients by SusClientId</a></h2>
                <div class="summary"><p>Today someone showed me a strange problem - he had servers that recently
installed new updates from his WSUS server, but he couldn't find them in
the WSUS console by their name.<br>
Obviously the servers have been renamed and didn't have time to report
to the WSUS server, but he wanted …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/finding-wsus-clients-by-susclientid.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.backslasher.net/setting-dynamic-rpc-port-ranges.html">Setting Dynamic RPC Port Ranges</a></h2>
                <div class="summary"><p>We recently had to manually set the dynamic RPC port range in our
servers, mainly because Exchange 2010 sets the port range so wide that
the firewall guys (rightfully) refused to create a rule with that
range.  </p>
<h3>Warning - at your own risk!</h3>
<p>When I found out about those settings, I …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/setting-dynamic-rpc-port-ranges.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.backslasher.net/enabling-remote-desktop-remotely.html">Enabling Remote Desktop Remotely</a></h2>
                <div class="summary"><p>According to <a href="http://technet.microsoft.com/en-us/library/cc782195%28v=ws.10%29.aspx">this Technet article</a>, to enable remote desktop remotely by using the registry you need to set the key</p>
<div class="highlight"><pre><span></span><code><span class="na">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server:fDenyTSConnections</span><span class="o">=</span><span class="s">0</span>
</code></pre></div>

<p>and then reboot the server.<br>
Rebooting is actually unnecessary - you can just restart the service <code>TermService</code><br>
If you'd like to script it …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/enabling-remote-desktop-remotely.html">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.backslasher.net/event-log-permissions-with-scripts.html">Event Log Permissions, With Scripts!</a></h2>
                <div class="summary"><p>I'm going to keep it short, because there's a lot of technical background.<br>
So, I'm assuming you know about:  </p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/cc728310%28WS.10%29.aspx">Assigning permissions to the registry</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/aa379567%28v=vs.85%29.aspx">SDDLs</a></li>
<li>Event Log concepts (sources, logs)</li>
</ul>
<p>So, to business:  </p>
<h3>Intro</h3>
<p>Event viewer data is stored in <code>.evt</code>/<code>.evtx</code> files in <code>%SystemRoot%\System32\Winevt\Logs\</code>, but as …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.backslasher.net/event-log-permissions-with-scripts.html">more ...</a>
                </div>
            </article>
            <hr/>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="http://github.com/BackSlasher"><i class="fa fa-github-square fa-lg"></i> github</a></li>
    <li class="list-group-item"><a href="http://il.linkedin.com/in/nitzanraz/"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
    <li class="list-group-item"><a href="http://careers.stackoverflow.com/backslasher"><i class="fa fa-stack-overflow fa-lg"></i> stack-overflow</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="https://blog.backslasher.net/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group " id="tags">
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/scripts.html">Scripts</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/powershell.html">PowerShell</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/linux.html">Linux</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/security.html">Security</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/mysteries-solved.html">Mysteries Solved</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://blog.backslasher.net/tag/active-directory.html">Active Directory</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/ruby.html">Ruby</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/windows.html">Windows</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/chef.html">Chef</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/bash.html">Bash</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/ramblings.html">Ramblings</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/python.html">Python</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/one-liner.html">One-Liner</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/group-policy.html">Group Policy</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://blog.backslasher.net/tag/sharepoint.html">SharePoint</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="https://blog.backslasher.net/tag/http.html">HTTP</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="https://blog.backslasher.net/tag/registry.html">Registry</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://blog.backslasher.net/tag/filesystem.html">FileSystem</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://blog.backslasher.net/tag/programming.html">Programming</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://blog.backslasher.net/tag/kerberos.html">Kerberos</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="http://getpelican.com/" target="_blank">Pelican</a>
    </li>
    <li class="list-group-item">
      <a href="http://python.org/" target="_blank">Python.org</a>
    </li>
    <li class="list-group-item">
      <a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Nitz
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blog.backslasher.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blog.backslasher.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blog.backslasher.net/theme/js/respond.min.js"></script>


    <!-- Google Analytics Universal -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-9527207-7', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics Universal Code -->


</body>
</html>